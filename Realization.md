# Разделение задач и стратегия выполнения

Для успешной реализации проекта важно разделить его на логические шаги с последовательным выполнением. Вот подробный план:

---

## Шаг 1. **Подготовка окружения и настройка инфраструктуры**

1. **Настройка базы данных и очередей**:

   - Выбор и установка базы данных (PostgreSQL).
   - Установка и настройка Redis или RabbitMQ.

2. **Интеграция с сервисом sms.ru**:

   - Регистрация на sms.ru, получение API ключа.
   - Создание базового кода для обращения к API sms.ru и тестирование отправки SMS.

3. **Todo List**:

   - [ ] Установить PostgreSQL.
   - [ ] Настроить Redis или RabbitMQ.
   - [ ] Зарегистрироваться на sms.ru и получить API ключ.

4. **Совет**: Используй `docker-compose` для настройки базы данных и очереди — это позволит легко управлять компонентами системы.

---

## Шаг 2. **Создание REST API**

1. **Описание API**:

   - Методы для отправки SMS, проверки статуса и получения списка сообщений.
   - Аутентификация через API ключ.

2. **Обработка запросов**:

   - Создание хендлеров для работы с очередями и базой данных.
   - Реализация отправки сообщений через API sms.ru.

3. **Todo List**:

   - [ ] Реализовать REST API для отправки SMS.
   - [ ] Добавить маршруты для проверки статуса сообщений.
   - [ ] Настроить аутентификацию (через API ключ).

4. **Совет**: Используй фреймворк Echo или Gin Gonic для реализации REST API, так как они облегчают работу с маршрутами и middleware.

---

## Шаг 3. **Очереди и асинхронная обработка**

1. **Создание системы очередей**:

   - Очередь должна принимать сообщения на отправку и передавать их в sms.ru.
   - Добавить воркер для обработки сообщений из очереди.
   - Реализация логики повторной попытки отправки в случае ошибки.

2. **Todo List**:

   - [ ] Настроить подключение к Redis или RabbitMQ.
   - [ ] Реализовать систему очередей и воркеров.

3. **Совет**: Важный аспект — ограничение на количество повторных попыток при ошибке отправки сообщения. Используй Redis как простой и эффективный вариант для очередей.

---

## Шаг 4. **Создание UI для отправки сообщений**

1. **UI для отправки SMS**:

   - Поля для номера телефона и текста сообщения.
   - Обратная связь по статусу отправки (успех/ошибка).
   - Логирование успешных и неудачных попыток отправки сообщений.

2. **Todo List**:

   - [ ] Создать веб-интерфейс для отправки SMS (HTML, CSS, JavaScript).
   - [ ] Добавить обработку статусов отправки.

3. **Совет**: Используй простую верстку с Vue.js или React для взаимодействия с API. Это улучшит пользовательский опыт и упростит работу с интерфейсом.

---

## Шаг 5. **Логирование и мониторинг**

1. **Логирование**:

   - Логирование всех попыток отправки и получения ответов от sms.ru.
   - Ведение логов по ошибкам и успешным сообщениям.

2. **Мониторинг**:

   - Отображение состояния очередей и работы воркеров.
   - Простая панель мониторинга для отслеживания количества сообщений в очереди.

3. **Todo List**:

   - [ ] Добавить логирование операций в базе данных.
   - [ ] Реализовать панель мониторинга для отображения состояния системы.

4. **Совет**: Логи и мониторинг важны для выявления проблем с очередями или отправкой сообщений, особенно при высоких нагрузках. Важно добавить ротацию логов, чтобы они не перегружали диск.

---

## Шаг 6. **Тестирование и финальная настройка**

1. **Тестирование функционала**:

   - Тесты для всех методов API.
   - Проверка корректной работы очередей и отправки SMS.
   - Функциональные тесты для UI.

2. **Todo List**:

   - [ ] Написать unit-тесты для хендлеров API.
   - [ ] Провести нагрузочное тестирование очередей и отправки SMS.

3. **Совет**: Протестируй систему под высокой нагрузкой, чтобы убедиться в её стабильности.

---

## Шаг 7. **Документация и деплой**

1. **Документация**:

   - Описание API, работы с очередями и воркерами.
   - Инструкция по развертыванию системы с использованием Docker.

2. **Финальный деплой**:

   - Залить проект на GitHub/GitLab.
   - Написать `README` с инструкциями по установке и использованию.

3. **Todo List**:

   - [ ] Загрузить проект на GitHub/GitLab.
   - [ ] Оформить документацию и добавить её в репозиторий.

4. **Совет**: Проверь совместимость системы с различными окружениями, используя контейнеризацию (например, Docker).

---

## Примерная архитектура системы:

1. **Backend (Go)**:

   - `handlers.go`: Основные хендлеры для обработки REST запросов.
   - `sms_service.go`: Логика взаимодействия с API sms.ru.
   - `queue_service.go`: Взаимодействие с очередью для обработки сообщений.
   - `worker.go`: Воркер для обработки SMS в очереди.

2. **Frontend (HTML/CSS/JS)**:
   - Простой интерфейс с Vue.js/React.
   - Поля ввода номера телефона, сообщения, и кнопка отправки.

---

## Промпты:

1. **На данный момент твой основной фокус на настройке базовой архитектуры с очередями. Проверь, что все системы правильно взаимодействуют между собой (БД, Redis/RabbitMQ и API sms.ru).**
2. **Далее начнем реализацию функционала UI, чтобы в реальном времени тестировать функционал отправки SMS через веб-интерфейс.**
